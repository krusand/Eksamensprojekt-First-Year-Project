for (i in 1:1000) {
n <- 200
p <- 0.3
samples <- rgeom(n,p)
p_1 <- 1/mean(samples)
p_2 <- estimate_p(samples)
dif_1 <- c(dif_1, p_1-p)
dif_2 <- c(dif_2, p_2-p)
}
plot(density(dif_1), col='red', xlim=c(-0.1,0.32), ylim=c(0,25))
lines(density(dif_2), col='blue')
set.seed(18042023)
dif_1 <- c()
dif_2 <- c()
for (i in 1:1000) {
n <- 200
p <- 0.3
samples <- rgeom(n,p)
p_1 <- 1/mean(samples)
p_2 <- estimate_p(samples)
dif_1 <- c(dif_1, p_1-p)
dif_2 <- c(dif_2, p_2-p)
}
plot(density(dif_1), col='red', xlim=c(-0.1,0.32), ylim=c(0,25), xlab='', main='Errors for estimates of p')
lines(density(dif_2), col='blue')
set.seed(18042023)
dif_1 <- c()
dif_2 <- c()
for (i in 1:1000) {
n <- 200
p <- 0.3
samples <- rgeom(n,p)
p_1 <- 1/mean(samples)
p_2 <- estimate_p(samples)
dif_1 <- c(dif_1, p_1-p)
dif_2 <- c(dif_2, p_2-p)
}
plot(density(dif_1), col='red', xlim=c(-0.1,0.32), ylim=c(0,25), xlab='', main='Errors for estimates of p')
lines(density(dif_2), col='blue')
legend(0.23, 24, legend=c("p^ error", "p* error"),
col=c("red", "blue"), lty=1:2, cex=0.8)
set.seed(18042023)
dif_1 <- c()
dif_2 <- c()
for (i in 1:1000) {
n <- 200
p <- 0.3
samples <- rgeom(n,p)
p_1 <- 1/mean(samples)
p_2 <- estimate_p(samples)
dif_1 <- c(dif_1, p_1-p)
dif_2 <- c(dif_2, p_2-p)
}
plot(density(dif_1), col='red', xlim=c(-0.1,0.32), ylim=c(0,25), xlab='', main='Errors for estimates of p')
lines(density(dif_2), col='blue')
legend(0.26, 24.5, legend=c("p^ error", "p* error"),
col=c("red", "blue"), lty=1:2, cex=0.8)
set.seed(18042023)
dif_1 <- c()
dif_2 <- c()
for (i in 1:1000) {
n <- 200
p <- 0.3
samples <- rgeom(n,p)
p_1 <- 1/mean(samples)
p_2 <- estimate_p(samples)
dif_1 <- c(dif_1, p_1-p)
dif_2 <- c(dif_2, p_2-p)
}
plot(density(dif_1), col='red', xlim=c(-0.1,0.32), ylim=c(0,25), xlab='', main='Errors for estimates of p')
lines(density(dif_2), col='blue')
legend(0.255, 24.5, legend=c("p^ error", "p* error"),
col=c("red", "blue"), lty=1:2, cex=0.8)
library(MASS)
data <- MASS::Cars93
plot(data$MPG.highway~data$Horsepower)
plot(data$MPG.highway~data$Horsepower)
model <- lm(data$MPG.highway~data$Horsepower)
abline(model, col = "blue")
print(model)
plot(data$MPG.highway~data$Horsepower)
model <- lm(data$MPG.highway~data$Horsepower)
abline(model, col = "blue")
print(model)
model$coefficients[1]
model$coefficients[1]+model$coefficients[2]*255
model$coefficients[1]+model$coefficients[2]*255
abline(0,0)
plot(fitted(model), resis(model))
plot(fitted(model), resid(model))
abline(0,0)
plot(data$Horsepower, resid(model))
plot(data$Horsepower, resid(model))
abline(0,0)
plot(data$Horsepower, resid(model), main='Residuals of model against the horsepower')
plot(data$Horsepower, resid(model), main='Residuals of model against the horsepower', xlab='Horsepower', ylab='Residual')
abline(0,0)
knitr::opts_chunk$set(echo = TRUE)
library(UsingR)
data <- cats
View(data)
library(UsingR)
data <- cats
females <- subset.data(Sex=='F')
females <- subset(data, Sex=='F')
View(females)
females <- subset(data, Sex=='F')
n <- len(females$Sex)
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(mu_f_bw)
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(mu_f_bw-margin_f_bw, mu_f_bw+margin_f_bw)
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(mu_f_hw)
margin_f_hw <- qt(alpha/2,n-1)*sd_f_hw/sqrt(n)
print(mu_f_hw-margin_f_hw, mu_f_hw+margin_f_hw)
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(mu_f_bw)
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(mu_f_bw-margin_f_bw; mu_f_bw+margin_f_bw)
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(mu_f_bw)
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(mu_f_bw-margin_f_bw); print(mu_f_bw+margin_f_bw)
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(mu_f_hw)
margin_f_hw <- qt(alpha/2,n-1)*sd_f_hw/sqrt(n)
print(mu_f_hw-margin_f_hw, mu_f_hw+margin_f_hw)
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(mu_f_bw)
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(paste('lower bound is',mu_f_bw-margin_f_bw));
print(mu_f_bw+margin_f_bw)
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(mu_f_hw)
margin_f_hw <- qt(alpha/2,n-1)*sd_f_hw/sqrt(n)
print(mu_f_hw-margin_f_hw, mu_f_hw+margin_f_hw)
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(paste('mu female bodyweight:', mu_f_bw))
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(paste('lower bound female bodyweight:', mu_f_bw-margin_f_bw));
print(paste('upper bound female bodyweight:', mu_f_bw+margin_f_bw))
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(paste('mu female heart weight:', mu_f_hw))
margin_f_hw <- qt(alpha/2,n-1)*sd_f_hw/sqrt(n)
print(paste('lower bound female heart weight:', mu_f_hw-margin_f_hw))
print(paste('upper bound female heart weight:', mu_f_hw+margin_f_hw))
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(paste('mu female bodyweight:', mu_f_bw))
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(paste('lower bound female bodyweight:', mu_f_bw-margin_f_bw));
print(paste('upper bound female bodyweight:', mu_f_bw+margin_f_bw))
print(margin_f_bw)
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(paste('mu female heart weight:', mu_f_hw))
margin_f_hw <- qt(alpha/2,n-1)*sd_f_hw/sqrt(n)
print(paste('lower bound female heart weight:', mu_f_hw-margin_f_hw))
print(paste('upper bound female heart weight:', mu_f_hw+margin_f_hw))
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(paste('mu female bodyweight:', mu_f_bw))
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(paste('lower bound female bodyweight:', mu_f_bw-margin_f_bw));
print(paste('upper bound female bodyweight:', mu_f_bw+margin_f_bw))
print(qt(alpha/2,n-1))
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(paste('mu female heart weight:', mu_f_hw))
margin_f_hw <- qt(alpha/2,n-1)*sd_f_hw/sqrt(n)
print(paste('lower bound female heart weight:', mu_f_hw-margin_f_hw))
print(paste('upper bound female heart weight:', mu_f_hw+margin_f_hw))
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(paste('mu female bodyweight:', mu_f_bw))
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(paste('lower bound female bodyweight:', mu_f_bw-margin_f_bw));
print(paste('upper bound female bodyweight:', mu_f_bw+margin_f_bw))
print(qt(alpha/2,df=n-1))
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(paste('mu female heart weight:', mu_f_hw))
margin_f_hw <- qt(alpha/2,n-1)*sd_f_hw/sqrt(n)
print(paste('lower bound female heart weight:', mu_f_hw-margin_f_hw))
print(paste('upper bound female heart weight:', mu_f_hw+margin_f_hw))
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(paste('mu female bodyweight:', mu_f_bw))
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(paste('lower bound female bodyweight:', mu_f_bw-margin_f_bw));
print(paste('upper bound female bodyweight:', mu_f_bw+margin_f_bw))
print(n)
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(paste('mu female heart weight:', mu_f_hw))
margin_f_hw <- qt(alpha/2,n-1)*sd_f_hw/sqrt(n)
print(paste('lower bound female heart weight:', mu_f_hw-margin_f_hw))
print(paste('upper bound female heart weight:', mu_f_hw+margin_f_hw))
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(paste('mu female bodyweight:', mu_f_bw))
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(paste('lower bound female bodyweight:', mu_f_bw-margin_f_bw));
print(paste('upper bound female bodyweight:', mu_f_bw+margin_f_bw))
print(sd_f_bw)
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(paste('mu female heart weight:', mu_f_hw))
margin_f_hw <- qt(alpha/2,n-1)*sd_f_hw/sqrt(n)
print(paste('lower bound female heart weight:', mu_f_hw-margin_f_hw))
print(paste('upper bound female heart weight:', mu_f_hw+margin_f_hw))
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(paste('mu female bodyweight:', mu_f_bw))
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(paste('lower bound female bodyweight:', mu_f_bw-margin_f_bw));
print(paste('upper bound female bodyweight:', mu_f_bw+margin_f_bw))
print(qt(0.975,29))
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(paste('mu female heart weight:', mu_f_hw))
margin_f_hw <- qt(alpha/2,n-1)*sd_f_hw/sqrt(n)
print(paste('lower bound female heart weight:', mu_f_hw-margin_f_hw))
print(paste('upper bound female heart weight:', mu_f_hw+margin_f_hw))
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(paste('mu female bodyweight:', mu_f_bw))
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(paste('lower bound female bodyweight:', mu_f_bw-margin_f_bw));
print(paste('upper bound female bodyweight:', mu_f_bw+margin_f_bw))
print(qt(0.05, 46))
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(paste('mu female heart weight:', mu_f_hw))
margin_f_hw <- qt(alpha/2,n-1)*sd_f_hw/sqrt(n)
print(paste('lower bound female heart weight:', mu_f_hw-margin_f_hw))
print(paste('upper bound female heart weight:', mu_f_hw+margin_f_hw))
females <- subset(data, Sex=='F')
n <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(paste('mu female bodyweight:', mu_f_bw))
margin_f_bw <- qt(alpha/2,n-1)*sd_f_bw/sqrt(n)
print(paste('lower bound female bodyweight:', mu_f_bw-margin_f_bw));
print(paste('upper bound female bodyweight:', mu_f_bw+margin_f_bw))
print(qt(0.05, 46, lower.tail = FALSE))
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(paste('mu female heart weight:', mu_f_hw))
margin_f_hw <- qt(alpha/2,n-1)*sd_f_hw/sqrt(n)
print(paste('lower bound female heart weight:', mu_f_hw-margin_f_hw))
print(paste('upper bound female heart weight:', mu_f_hw+margin_f_hw))
females <- subset(data, Sex=='F')
n_f <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(paste('mu female bodyweight:', mu_f_bw))
margin_f_bw <- qt(alpha/2,n_f-1,lower.tail = FALSE)*sd_f_bw/sqrt(n_f)
print(paste('lower bound female bodyweight:', mu_f_bw-margin_f_bw));
print(paste('upper bound female bodyweight:', mu_f_bw+margin_f_bw))
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(paste('mu female heart weight:', mu_f_hw))
margin_f_hw <- qt(alpha/2,n_f-1)*sd_f_hw/sqrt(n_f)
print(paste('lower bound female heart weight:', mu_f_hw-margin_f_hw))
print(paste('upper bound female heart weight:', mu_f_hw+margin_f_hw))
females <- subset(data, Sex=='F')
n_f <- length(females$Sex)
alpha <- 0.1
mu_f_bw <- mean(females$Bwt)
sd_f_bw <- sd(females$Bwt)
print(paste('mu female bodyweight:', mu_f_bw))
margin_f_bw <- qt(alpha/2,n_f-1,lower.tail = FALSE)*sd_f_bw/sqrt(n_f)
print(paste('lower bound female bodyweight:', mu_f_bw-margin_f_bw));
print(paste('upper bound female bodyweight:', mu_f_bw+margin_f_bw))
mu_f_hw <- mean(females$Hwt)
sd_f_hw <- sd(females$Hwt)
print(paste('mu female heart weight:', mu_f_hw))
margin_f_hw <- qt(alpha/2,n_f-1,lower.tail = FALSE)*sd_f_hw/sqrt(n_f)
print(paste('lower bound female heart weight:', mu_f_hw-margin_f_hw))
print(paste('upper bound female heart weight:', mu_f_hw+margin_f_hw))
males <- subset(data, Sex=='M')
n_m <- length(males$Sex)
alpha <- 0.1
mu_m_bw <- mean(males$Bwt)
sd_m_bw <- sd(males$Bwt)
print(paste('mu male bodyweight:', mu_m_bw))
margin_m_bw <- qt(alpha/2,n_m-1,lower.tail = FALSE)*sd_m_bw/sqrt(n_m)
print(paste('lower bound male bodyweight:', mu_m_bw-margin_m_bw));
print(paste('upper bound male bodyweight:', mu_m_bw+margin_m_bw))
mu_m_hw <- mean(males$Hwt)
sd_m_hw <- sd(males$Hwt)
print(paste('mu male heart weight:', mu_m_hw))
margin_m_hw <- qt(alpha/2,n_m-1,lower.tail = FALSE)*sd_m_hw/sqrt(n_m)
print(paste('lower bound male heart weight:', mu_m_hw-margin_m_hw))
print(paste('upper bound male heart weight:', mu_m_hw+margin_m_hw))
plot(hline(1,2))
abline(0,1)
plot(abline(0,1))
plot()
plot(0,0)
abline(h=0)
abline(h=0)
t.test(males$Bwt, mu_m_bw)
t.test(males$Bwt, mu_m_bw, alternative='greater')
t.test(males$Bwt, mu=mu_m_bw, alternative='greater')
mu_m_bw-margin_m_bw
mu_m_bw-qt(alpha,n_m-1)*sd_m_bw/sqrt(n_m)
mu_m_bw+qt(alpha,n_m-1)*sd_m_bw/sqrt(n_m)
quantile(c(1,2,3,4), 0.5)
bootstrap_means <- c()
set.seed(250423)
for (i in 1:500) {
bootstrap_sample <-
sample(males$Bwt, size = n_m, replace = TRUE)
bootstrap_means <- c(bootstrap_means, (mean(bootstrap_sample-mu_m_bw))/(sd(bootstrap_sample)/sqrt(n_m)))
}
# bootstrap_data <- data.frame(bootstrap_means)
c_u <- quantile(bootstrap_means, 0.05)
c_l <- quantile(bootstrap_means, 0.95)
c_u <- quantile(bootstrap_means, 0.05)
c_l <- quantile(bootstrap_means, 0.95)
print(paste('lower bound for bootstrapped CI:', mu_m_bw-c_u*sd_m_bw/sqrt(n_m)))
c_l <- quantile(bootstrap_means, 0.05)
c_u <- quantile(bootstrap_means, 0.95)
print(paste('lower bound for bootstrapped CI:', mu_m_bw-c_u*sd_m_bw/sqrt(n_m)))
print(paste('upper bound for bootstrapped CI:', mu_m_bw-c_l*sd_m_bw/sqrt(n_m)))
knitr::opts_chunk$set(echo = TRUE)
qnorm(0.015, lower.tail = FALSE)
library(UsingR)
library(UsingR)
data <- data.frame(babies)
View(data)
x <- data$age
y <- data$dage
n <- length(x)
m <- length(y)
x_bar <- mean(x)
y_bar <- mean(y)
s_d <- sqrt(var(x)/length(x) + var(y)/length(y))
t_d <- (mean(x) - mean(y)) / s_d; t_d;
alpha <- 0.05; t_d_s_samples = c();x
for (i in 1:10000) {
x_s <- sample(x, n, replace=TRUE)
y_s <- sample(y, m, replace=TRUE)
s_d_s <- sqrt(var(x_s)/n + var(y_s)/m)
t_d_s <- ( (mean(x_s)-mean(y_s)) - (x_bar-y_bar) ) / s_d_s
t_d_s_samples <- c(t_d_s_samples, t_d_s)
}
quantile(t_d_s_samples, probs=c(alpha/2, 1-alpha/2))
mean(t_d_s_samples < t_d)
x <- data$age
y <- data$dage
n <- length(x)
m <- length(y)
x_bar <- mean(x)
y_bar <- mean(y)
s_d <- sqrt(var(x)/length(x) + var(y)/length(y))
t_d <- (mean(x) - mean(y)) / s_d; t_d;
alpha <- 0.05; t_d_s_samples = c();x
for (i in 1:10000) {
x_s <- sample(x, n, replace=TRUE)
y_s <- sample(y, m, replace=TRUE)
s_d_s <- sqrt(var(x_s)/n + var(y_s)/m)
t_d_s <- ( (mean(x_s)-mean(y_s)) - (x_bar-y_bar) ) / s_d_s
t_d_s_samples <- c(t_d_s_samples, t_d_s)
}
quantile(t_d_s_samples, probs=alpha)
mean(t_d_s_samples < t_d)
mean(values<4)
values <- c(1,2,3,4,5)
mean(values<4)
setwd("~/Data Science/GitHub/Eksamensprojekt-First-Year-Project")
metadata <- read.csv(file = "metadata.csv")
library(ggplot2)
cols <- c('darkgoldenrod', 'goldenrod', 'khaki', 'navy', 'royalblue', 'cornflowerblue')
legend_order <- c('BCC', 'MEL', 'SCC', 'ACK', 'NEV', 'SEK')
n <- length(metadata$diagnostic)
skin_dis <- sum(metadata$diagnostic == "ACK") + sum(metadata$diagnostic == "NEV") + sum(metadata$diagnostic == "SEK")
skin_can <- sum(metadata$diagnostic == "BCC") + sum(metadata$diagnostic == "MEL") + sum(metadata$diagnostic == "SCC")
group <- c(rep("Skin diseases" , 3) , rep("Skin cancer" , 3))
diagnostic <- c("ACK" , "NEV" , "SEK", "BCC", "MEL", "SCC")
freq <- c(sum(metadata$diagnostic == "ACK"), sum(metadata$diagnostic == "NEV"), sum(metadata$diagnostic == "SEK"), sum(metadata$diagnostic == "BCC"), sum(metadata$diagnostic == "MEL"), sum(metadata$diagnostic == "SCC"))
perc <- c(sum(metadata$diagnostic == "ACK")/skin_dis)
data <- data.frame(group, diagnostic, freq)
ggplot(data, aes(fill=diagnostic, y=freq, x=group)) +
geom_bar(position="dodge", stat="identity") +
labs(title='Frequencies of diagnoses in metadata') +
theme(plot.title = element_text(hjust = 0.5)) +
xlab('') +
ylab('') +
scale_fill_manual(values=cols, breaks=legend_order) +
#scale_fill_discrete(breaks=legend_order, values=cols) +
#theme(legend.position="none") +
geom_text(position = position_dodge(width= 0.9), aes(y=freq+30, label=freq))
perc <- c(sum(metadata$diagnostic == "ACK")/skin_dis, sum(metadata$diagnostic == "NEV")/skin_dis, sum(metadata$diagnostic == "SEK")/skin_dis, sum(metadata$diagnostic == "BCC")/skin_can, sum(metadata$diagnostic == "MEL")/skin_can, sum(metadata$diagnostic == "SCC")/skin_can)
ggplot(data, aes(fill=diagnostic, y=freq, x=group)) +
geom_bar(position="dodge", stat="identity") +
labs(title='Frequencies of diagnoses in metadata') +
theme(plot.title = element_text(hjust = 0.5)) +
xlab('') +
ylab('') +
scale_fill_manual(values=cols, breaks=legend_order) +
#scale_fill_discrete(breaks=legend_order, values=cols) +
#theme(legend.position="none") +
geom_text(position = position_dodge(width= 0.9), aes(y=freq+30, label=perc))
perc <- round(perc, digits = 2)
ggplot(data, aes(fill=diagnostic, y=freq, x=group)) +
geom_bar(position="dodge", stat="identity") +
labs(title='Frequencies of diagnoses in metadata') +
theme(plot.title = element_text(hjust = 0.5)) +
xlab('') +
ylab('') +
scale_fill_manual(values=cols, breaks=legend_order) +
#scale_fill_discrete(breaks=legend_order, values=cols) +
#theme(legend.position="none") +
geom_text(position = position_dodge(width= 0.9), aes(y=freq+30, label=perc))
perc <- round(perc, digits = 3)
ggplot(data, aes(fill=diagnostic, y=freq, x=group)) +
geom_bar(position="dodge", stat="identity") +
labs(title='Frequencies of diagnoses in metadata') +
theme(plot.title = element_text(hjust = 0.5)) +
xlab('') +
ylab('') +
scale_fill_manual(values=cols, breaks=legend_order) +
#scale_fill_discrete(breaks=legend_order, values=cols) +
#theme(legend.position="none") +
geom_text(position = position_dodge(width= 0.9), aes(y=freq+30, label=perc))
perc <- c(sum(metadata$diagnostic == "ACK")/skin_dis, sum(metadata$diagnostic == "NEV")/skin_dis, sum(metadata$diagnostic == "SEK")/skin_dis, sum(metadata$diagnostic == "BCC")/skin_can, sum(metadata$diagnostic == "MEL")/skin_can, sum(metadata$diagnostic == "SCC")/skin_can)
perc <- round(perc, digits = 3)
ggplot(data, aes(fill=diagnostic, y=freq, x=group)) +
geom_bar(position="dodge", stat="identity") +
labs(title='Frequencies of diagnoses in metadata') +
theme(plot.title = element_text(hjust = 0.5)) +
xlab('') +
ylab('') +
scale_fill_manual(values=cols, breaks=legend_order) +
#scale_fill_discrete(breaks=legend_order, values=cols) +
#theme(legend.position="none") +
geom_text(position = position_dodge(width= 0.9), aes(y=freq+30, label=perc))
perc <- c(sum(metadata$diagnostic == "ACK")/skin_dis, sum(metadata$diagnostic == "NEV")/skin_dis, sum(metadata$diagnostic == "SEK")/skin_dis, sum(metadata$diagnostic == "BCC")/skin_can, sum(metadata$diagnostic == "MEL")/skin_can, sum(metadata$diagnostic == "SCC")/skin_can)
perc <- round(perc, digits = 2)
ggplot(data, aes(fill=diagnostic, y=freq, x=group)) +
geom_bar(position="dodge", stat="identity") +
labs(title='Frequencies of diagnoses in metadata') +
theme(plot.title = element_text(hjust = 0.5)) +
xlab('') +
ylab('') +
scale_fill_manual(values=cols, breaks=legend_order) +
#scale_fill_discrete(breaks=legend_order, values=cols) +
#theme(legend.position="none") +
geom_text(position = position_dodge(width= 0.9), aes(y=freq+30, label=perc))
perc <- c(sum(metadata$diagnostic == "ACK")/skin_dis, sum(metadata$diagnostic == "NEV")/skin_dis, sum(metadata$diagnostic == "SEK")/skin_dis, sum(metadata$diagnostic == "BCC")/skin_can, sum(metadata$diagnostic == "MEL")/skin_can, sum(metadata$diagnostic == "SCC")/skin_can)
perc <- round(perc, digits = 3)
ggplot(data, aes(fill=diagnostic, y=freq, x=group)) +
geom_bar(position="dodge", stat="identity") +
labs(title='Frequencies of diagnoses in metadata') +
theme(plot.title = element_text(hjust = 0.5)) +
xlab('') +
ylab('') +
scale_fill_manual(values=cols, breaks=legend_order) +
#scale_fill_discrete(breaks=legend_order, values=cols) +
#theme(legend.position="none") +
geom_text(position = position_dodge(width= 0.9), aes(y=freq+30, label=perc))
